import socket
import subprocess
import sys
import os

subprocess.call('clear', shell=True)

#path to output file for search results
file1 = "/Users/crispreet/Desktop/searchsploit.txt"

#Services to search for in Searchsploit 
#This can be edited to include all of the searches that one wishes to do on a system
search1 = "vsftpd 2.3"
search2 = "BIND 9.4"

#Searching for the search items search 1 and search2 on searchsploit and writing to an output file 
#called searchsploit.txt


#This segment opens the output file for writing to it and clears the file of any remaining data
file = open(file1 , "w")
with open(file1, 'r+') as f:
    f.seek(0)
    f.truncate()

file = open(file1 , "a") #File is opened for appending to it

#Labels what search results are listed below in the output file
file.write("Searchsploit Results for " + search1 + "\n\n\n")
file = open(file1 , "a") #File is opened for appending to it

#Runs the seach on terminal and prints the output of the search1 to an output file which is searchsploit.txt
subprocess.run("searchsploit " + search1, shell=True, stdout=file) 
file.write("-" * 100 + "\n\n") #creates a divider between mutiple searches

#*************************************************************************************************************#

file = open(file1 , "a") #File is opened for appending to it

#Labels what search results are listed below in the output file
file.write("Searchsploit Results for " + search2 + "\n\n\n")
file = open(file1 , "a") #File is opened for appending to it

#Runs the seach on terminal and prints the output of the search2 to an output file which is searchsploit.txt
subprocess.run("searchsploit " + search2, shell=True, stdout=file) 
file.write("-" * 100 + "\n\n") #creates a divider between mutiple searches

file.close() #closes file


